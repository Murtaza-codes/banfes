{% load i18n %}

<!-- PLYR Video Player Component -->
<div class="plyr__component">
  <!-- PLYR CSS -->
  <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
  
  <!-- PLYR JavaScript -->
  <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize Plyr for all video players
      const players = Array.from(document.querySelectorAll('.video-player')).map(player => new Plyr(player, {
        controls: [
          'play-large', 'play', 'progress', 'current-time', 'mute', 
          'volume', 'captions', 'settings', 'pip', 'airplay', 'fullscreen'
        ],
        iconUrl: 'https://cdn.plyr.io/3.7.8/plyr.svg',
        blankVideo: 'https://cdn.plyr.io/static/blank.mp4',
        hideControls: true,
        storage: { enabled: true, key: 'plyr' },
      }));
    });
  </script>
  
  <style>
    /* PLYR customization to match dashboard */
    .plyr {
      border-radius: 0.5rem;
      overflow: hidden;
      box-shadow: 0 .125rem .25rem rgba(0,0,0,.075);
    }
    .plyr--video {
      background-color: #000;
    }
    .plyr--full-ui input[type=range] {
      color: var(--bs-primary);
    }
    .plyr__control--overlaid {
      background: var(--bs-primary);
    }
    .plyr__control:hover {
      background: var(--bs-primary);
      color: #fff;
    }
    .plyr__menu__container .plyr__control[role=menuitemradio][aria-checked=true]:before {
      background: var(--bs-primary);
    }
  </style>
</div>

<!-- Toast Notification Component -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1080">
  <div id="courseToastContainer"></div>
</div>

<script>
  // Toast notification system
  const courseToast = {
    container: document.getElementById('courseToastContainer'),
    
    create: function(message, type = 'success', duration = 5000) {
      // Toast color classes based on type
      const typeClasses = {
        'success': 'text-bg-success',
        'warning': 'text-bg-warning',
        'error': 'text-bg-danger',
        'info': 'text-bg-info'
      };
      
      // Icons based on type
      const typeIcons = {
        'success': 'bi-check-circle',
        'warning': 'bi-exclamation-triangle',
        'error': 'bi-x-circle',
        'info': 'bi-info-circle'
      };
      
      // Create toast element
      const toastEl = document.createElement('div');
      toastEl.className = `toast align-items-center ${typeClasses[type]} border-0 mb-3`;
      toastEl.setAttribute('role', 'alert');
      toastEl.setAttribute('aria-live', 'assertive');
      toastEl.setAttribute('aria-atomic', 'true');
      
      // Create toast content
      toastEl.innerHTML = `
        <div class="d-flex">
          <div class="toast-body">
            <i class="bi ${typeIcons[type]} me-2"></i>
            ${message}
          </div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      `;
      
      // Append toast to container
      this.container.appendChild(toastEl);
      
      // Initialize Bootstrap toast
      const toast = new bootstrap.Toast(toastEl, {
        delay: duration,
        autohide: true
      });
      
      // Show toast
      toast.show();
      
      // Remove from DOM after hiding
      toastEl.addEventListener('hidden.bs.toast', function() {
        toastEl.remove();
      });
      
      return toast;
    },
    
    success: function(message, duration = 5000) {
      return this.create(message, 'success', duration);
    },
    
    warning: function(message, duration = 5000) {
      return this.create(message, 'warning', duration);
    },
    
    error: function(message, duration = 5000) {
      return this.create(message, 'error', duration);
    },
    
    info: function(message, duration = 5000) {
      return this.create(message, 'info', duration);
    }
  };
  
  // Example usage (commented out)
  // courseToast.success('Operation completed successfully!');
  // courseToast.warning('Please check your input.');
  // courseToast.error('An error occurred.');
  // courseToast.info('This is an informational message.');
</script> 