{% extends 'base.html' %}
{% load i18n %}
{% block title %}{{ title }} | {% trans 'Learning management system' %}{% endblock title %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}
<nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">{% trans 'Home' %}</a></li>
        <li class="breadcrumb-item active" aria-current="page">{% trans 'Course Registration' %}</li>
    </ol>
</nav>

<p class="title-1">{% trans 'Course Add' %} &amp; {% trans 'Drop' %}</p>

{% include 'snippets/messages.html' %}

<div class="col-md-12 p-0 bg-white">
    <p class="form-title fw-bold">{% trans 'Available Courses' %}</p>
    <div class="container">
        <form action="{% url 'course_registration' %}" method="POST">
            {% csrf_token %}
            <div class="d-flex justify-content-between mb-3">
                <button type="submit" class="btn btn-primary">
                    <i class="fa fa-plus"></i> {% trans 'Register Selected' %}
                </button>
            </div>

            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>{% trans 'Select' %}</th>
                            <th>{% trans 'Code' %}</th>
                            <th>{% trans 'Title' %}</th>
                            <th>{% trans 'Credits' %}</th>
                            <th>{% trans 'Year' %}</th>
                            <th>{% trans 'Type' %}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for course in courses %}
                        <tr>
                            <td><input type="checkbox" name="course_ids" value="{{ course.id }}"></td>
                            <td>{{ course.code }}</td>
                            <td>{{ course.title }}</td>
                            <td>{{ course.credit }}</td>
                            <td>{{ course.year }}</td>
                            <td>{% if course.is_elective %}{% trans 'Elective' %}{% else %}{% trans 'Core' %}{% endif %}</td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="6" class="text-center">{% trans 'No courses available' %}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </form>
    </div>
</div>

{% if registered_courses %}
<div class="col-md-12 p-0 bg-white mt-4">
    <p class="form-title fw-bold">{% trans 'Registered Courses' %}</p>
    <div class="container">
        <form action="{% url 'course_drop' %}" method="POST">
            {% csrf_token %}
            <div class="d-flex justify-content-between mb-3">
                <button type="submit" class="btn btn-danger">
                    <i class="fa fa-times"></i> {% trans 'Drop Selected' %}
                </button>
            </div>

            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>{% trans 'Select' %}</th>
                            <th>{% trans 'Code' %}</th>
                            <th>{% trans 'Title' %}</th>
                            <th>{% trans 'Credits' %}</th>
                            <th>{% trans 'Year' %}</th>
                            <th>{% trans 'Type' %}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for course in registered_courses %}
                        <tr>
                            <td><input type="checkbox" name="course_ids" value="{{ course.id }}"></td>
                            <td>{{ course.code }}</td>
                            <td>{{ course.title }}</td>
                            <td>{{ course.credit }}</td>
                            <td>{{ course.year }}</td>
                            <td>{% if course.is_elective %}{% trans 'Elective' %}{% else %}{% trans 'Core' %}{% endif %}</td>
                        </tr>
                        {% endfor %}
                        <tr>
                            <td colspan="3"></td>
                            <td colspan="3"><b>{% trans 'Total Credits:' %}</b> {{ total_registered_credit }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </form>
    </div>
</div>

<a class="btn btn-sm btn-secondary mt-3" href="{% url 'course_registration_form' %}" target="_blank" title="{% trans 'Print Registration Form' %}">
    <i class="fas fa-print"></i> {% trans 'Print Registered Courses' %}
</a>
{% endif %}

{% endblock content %}