<!-- templates/assignment/assignment_submissions.html -->
{% extends 'base.html' %}
{% load i18n %}
{% load custom_filters %}

{% block content %}

<!-- Breadcrumb Navigation -->
<nav aria-label="breadcrumb" class="mb-4">
    <ol class="breadcrumb bg-light p-2 rounded shadow-sm">
        <li class="breadcrumb-item"><a href="{% url 'home' %}" class="text-decoration-none"><i class="bi bi-house-door"></i> {% trans 'Home' %}</a></li>
        <li class="breadcrumb-item"><a href="{% url 'programs' %}" class="text-decoration-none"><i class="bi bi-collection"></i> {% trans 'Programs' %}</a></li>
        <li class="breadcrumb-item"><a href="{{ course.get_absolute_url }}" class="text-decoration-none"><i class="bi bi-book"></i> {{ course }}</a></li>
        <li class="breadcrumb-item"><a href="{% url 'assignment_list' course.slug %}" class="text-decoration-none"><i class="bi bi-clipboard-check"></i> {% trans 'Assignments' %}</a></li>
        <li class="breadcrumb-item active" aria-current="page"><i class="bi bi-inboxes"></i> {% trans 'Submissions' %}</li>
    </ol>
</nav>

<!-- Page Title -->
<div class="card border-0 shadow-sm mb-4">
    <div class="card-body bg-light">
        <h4 class="card-title d-flex align-items-center mb-0">
            <i class="bi bi-file-earmark-text text-primary me-2"></i>
            {% trans 'Submissions for' %} {{ assignment.title }}
        </h4>
    </div>
</div>

<div class="container px-0">
    {% if submissions %}
    <div class="card border-0 shadow-sm">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover m-0">
                    <thead class="bg-light">
                        <tr>
                            <th><i class="bi bi-person me-2"></i>{% trans 'Student' %}</th>
                            <th><i class="bi bi-calendar-date me-2"></i>{% trans 'Submitted At' %}</th>
                            <th><i class="bi bi-arrow-repeat me-2"></i>{% trans 'Attempts' %}</th>
                            <th><i class="bi bi-robot me-2"></i>{% trans 'AI Score' %}</th>
                            <th><i class="bi bi-mortarboard me-2"></i>{% trans 'Teacher Score' %}</th>
                            <th><i class="bi bi-award me-2"></i>{% trans 'Final Score' %}</th>
                            <th class="text-end"><i class="bi bi-gear me-2"></i>{% trans 'Actions' %}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for submission in submissions %}
                        <tr>
                            <td>{{ submission.student.get_full_name }}</td>
                            <td>{{ submission.updated_at }}</td>
                            <td>{{ submission.attempts }}</td>
                            <td>
                                {% if submission.ai_score is not None and submission.teacher_score is not None %}
                                    <span class="badge bg-info text-white">{{ submission.ai_score }} / 100</span>
                                {% else %}
                                    <span class="badge bg-secondary">{% trans 'N/A' %}</span>
                                {% endif %}
                            </td>
                            <td>
                                {% if submission.teacher_score %}
                                    <span class="badge bg-success text-white">{{ submission.teacher_score }} / 100</span>
                                {% else %}
                                    <span class="badge bg-warning text-dark">{% trans 'Not Graded' %}</span>
                                {% endif %}
                            </td>
                            <td>
                                {% if submission.final_score and submission.teacher_score is not None %}
                                    <span class="badge bg-primary">{{ submission.final_score }} / 100</span>
                                {% else %}
                                    <span class="badge bg-secondary">{% trans 'Pending' %}</span>
                                {% endif %}
                            </td>
                            <td class="text-end">
                                <a href="{% url 'assignment_submission_detail' slug=course.slug assignment_id=assignment.id submission_id=submission.id %}" class="btn btn-sm btn-outline-primary">
                                    <i class="bi bi-eye me-1"></i> {% trans 'View Submission' %}
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {% else %}
    <div class="alert alert-info d-flex align-items-center">
        <i class="bi bi-info-circle-fill me-2 fs-4"></i>
        <p class="mb-0">{% trans 'No submissions yet.' %}</p>
    </div>
    {% endif %}
</div>

{% endblock %}
